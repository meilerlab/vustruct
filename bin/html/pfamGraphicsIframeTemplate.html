<!DOCTYPE html>
<html>
<head lang="en">
		<meta charset="UTF-8" name="viewport" content="width=device-width, intial-scale=1">
		<title>myIframe</title>
      <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
      <link rel="stylesheet" href="css/typography.css">

    <!-- If user clicks a link in the table of seocndary structure, link to a new page -->
    <base target="_blank" />

    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">google.load("prototype", "1.7");</script>

    <!-- the following libraries are all hosted on the Pfam site, but can obviously be
         retrieved and served locally -->

    <!-- the domain graphics library -->
    <script type="text/javascript" src="https://pfam.xfam.org/static/javascripts/domain_graphics.js"></script>
    <script type='text/javascript' src='https://pfam.xfam.org/shared/javascripts/tablekit.js'></script>

    <!-- styles applicable to all browsers -->
    <link rel='stylesheet' href='https://pfam.xfam.org/static/css/tab_layout.css' type='text/css' />
    <link rel='stylesheet' href='https://pfam.xfam.org/static/css/protein.css' type='text/css' />

    <!-- in order to standardize the look of text, and in order to make it work at
         all in older browsers (and IE), we need the canvas text library. And, in turn,
         that library uses a font description in a separate javascript file -->
    <!--
      <script type="text/javascript" src="https://pfam.xfam.org/static/javascripts/canvas.text.js?dontUseMoz=true&amp;reimplement=true"></script>
    -->

    <script type="text/javascript" src="https://pfam.xfam.org/static/javascripts/canvas.text.js?dontUseMoz=true&amp;reimplement=true"></script>
    <script type="text/javascript" src="https://pfam.xfam.org/static/javascripts/faces/optimer-bold-normal.js"></script>

    <!-- we use the (non-free) prototip2 library to add tooltips. It's not free, but
         nearly. The domain graphics code should cope if it's not loaded, so you
         could just omit the prototip load -->
    <script type="text/javascript" src="https://pfam.xfam.org/shared/javascripts/prototip.js"></script>
    <script type="text/javascript" src="https://pfam.xfam.org/shared/javascripts/styles.js"></script>

    <!-- NGL molecular graphics viewer -->
    <script type="text/javascript" src="javascript/ngl.js"></script>

		<style type="text/css">
		h4{text-align:center;font-size:80px}
		h5{text-align:center;font-size:80px}
      </style>

    <!-- stylesheets. We only really need the rules that are specific to the tooltips -->
    <!-- Chris Moth moved these into "script" tags because our non-javascript renderer chokes enroute to .pdf otherwise -->
    <script>
    document.write('<link rel="stylesheet" href="https://pfam.xfam.org/static/css/pfam.css" type="text/css" />'); 
    document.write('<link rel="stylesheet" href="https://pfam.xfam.org/shared/css/prototip.css" type="text/css" />');
    </script>

    <!-- IE, being IE, needs extra help. In particular we need to add an extra library
         that implements <canvas> using the VML drawing layer in IE. And, so that 
         "console.log" calls don't screw everything up, we include the firebug-lite 
         script -->
    <!--[if IE]>
      <script type="text/javascript" src="https://pfam.xfam.org/static/javascripts/excanvas.js"></script>
      <script type="text/javascript" src="https://getfirebug.com/releases/lite/1.2/firebug-lite-compressed.js"></script>
    <![endif]-->

    <style type="text/css">
      #dg canvas { 
        margin: 2em;
      }
      #errors {
        border: 1px solid red;
        margin: 1em 0;
        padding: 0.4em;
      }
	</style>


<script type="text/javascript">

/* Code inspired by example at uniprot by:
 Copyright (c) 2011: Genome Research Ltd.
 
 Authors: Rob Finn (rdf@sanger.ac.uk), John Tate (jt6@sanger.ac.uk)
*/

var myUniprotGraphicGenerator = Class.create( {
  
  //
  //- constructor -
  //

  initialize: function( _DomainGraphicsJSON ) {
    console.log('Crazy in initialize right now');

    this._pg = new PfamGraphic();

    // stash the URL root
    this._json = JSON.parse(_DomainGraphicsJSON)[0];

    // set up sequence field

    // add listeners to the various buttons

   this.generate();
  },
  //
  //- methods -
  //
  
  generate: function() {

    // hide any previous error messages and remove the previous canvas element
    if ( $("dg").select("canvas").size() > 0 ) {
      $("dg").select("canvas").first().remove();
    }

   this._generate()

  },

  //
  //- private methods -
  //

  // actually generate the graphic
  _generate: function() {

    // set up the PfamGraphic object
    this._pg.setParent( "dg" );

    this._pg.setImageParams( {
    } );

    // render the sequence
    try {
      this._pg.setSequence( this._json );
      this._pg.render();
    } catch ( e ) {
      return;
    }
  },

  //

  clear: function() {
  }

  //

} );


document.write("<link rel='stylesheet' href='javascript/pfam.xfam.org/static/css/graphicTools.css' type='text/css' />");
DomainGraphicsJSON = 
'{{ DomainGraphicsJSON }}';
  window.onload = function() {
    var generator = new myUniprotGraphicGenerator( DomainGraphicsJSON );
  }



</script>




</head>
<body>
<div id="graphic" class="panel">
  <h5>{{graphicsLegend}}</h5>
  <div id="dg">
   </div>
</div>
</p>
{{ PfamResultTableHTML }}
    <p>
      <span id="showScores" class="link">Show</span> or
      <span id="hideScores" class="link">hide</span> domain scores.
    </p>

    <script type="text/javascript">
     document.observe( "dom:loaded", function() {
        $("showScores").observe( "click", function() {
          $$(".sh").invoke( "show" );
        } );
        $("hideScores").observe( "click", function() {
          $$(".sh").invoke( "hide" )
        } );
      } );
    </script>
</body>
</html>
